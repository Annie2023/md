# 操作系统

## 名词解释总结

临界资源：一次仅允许一个进程使用的资源

分时 时间片轮

硬实时：具有**截止时间**，不能满足会有**严重**后果的任务

微内核：操作系统分成若干分别完成一组特定功能的服务进程，等待客户提出请求。而系统内核只实现操作系统的基本功能，将更多操作系统功能放在核心之外，作为独立的服务进程运行

操作系统进程：具有独立功能的程序在一个数据集合上运行的过程,是系统进行**资源分配和调度的一个独立**单位

线程：作为调度和分派的基本单位

进程控制块(PCB)：描述进程的当前情况及管理进程运行的全部信息，使每个程序能独立地运行专门的**数据结构**，是进程存在的唯一标识

临界区：每个进程中访问**临界资源**的那段**代码**

有限等待：对要求访问临界资源的进程，保证**有限时间**进入自己临界区，避免“死等”

让权等待：进程不能进入自己临界区，**立即释放处理机**，避免“忙等”

管程：代表共享资源的数据结构以及由对共享数据结构实施操作的一组过程所组成的资源管理程序共同构成了一个操作系统的资源管理模块

高中低调度。。

**死锁**：一组进程中的每一个进程都在等待仅由该组进程中的其他进程才能引发的事件

**安全状态**：系统能按某种**顺序**为每个进程**分配**其所需的资源，直至满足每个进程对资源的**最大需求**，使每个进程都可**顺利地完成**

“**紧凑**”（碎片整理）：移动内存中作业的位置，以把原来多个分散的小分区拼接成一个大分区（移作业，小拼大）

**抖动**：页面在内存与外存频繁调度，以至于调度页面时间大于进程实际运行时间，甚至导致系统崩溃

<u>设备独立性</u>：应用程序独立于具体使用的物理设备

**文件控制块 (FCB**)：**为了对文件正确读取设置的用于描述和控制文件的数据结构**

**保护域**：**进程对一组对象访问权的集合**，进程只能在指定域内执行操作。规定了进程所能访问的对象和能执行的操作

FAT（文件分配表）：把文件各物理块的指针显示存放的一张链接表（仅一张）

RAID-冗余磁盘阵列:由很多便宜、容量较小、稳定性较高、速度较慢磁盘，组合成一个大型的磁盘组

感觉有英文名的容易考

## 简答题总结

1. 微内核概念+特点

````
足够小的内核
基于客户/服务器模式
应用“机制与策略分离”原理
采用面向对象技术
````

2. 进程创建的过程
      （进程创建原语Create()）

````
申请一个空白PCB
为新进程分配资源
初始化PCB
新进程加入到就绪队列
````

3. 同步机制
4. 记录型信号量（默认信号量类型）
   记录型信号量是由于采用了记录型的数据结构而得名的。
   一般是由两个成员组成：整形变量，表示该信号量的值；另一个是指向PCB的指针当多个进程都等待同一信号量时，它们就排成一个队列，由信号量的指针项指出该队列的头。信号量反映相应资源的使用情况，它与P、V操作原语一起使用可实现进程的同步和互斥（背）含义及使用
5. 进程间通信的方式

````
0.信号量机制(进程的互斥与同步); --传递信息量较小
传递信息量较大应采用：（填空1234，简答01234）
1.共享存储器系统;  （大致原理判断，效率快慢）
2.管道通信（共享文件）; 
3.消息传递系统（共享数据结构）
4.客户-服务器系统

以上具体情况具体分析，谈不上谁就一定最好，最快，分别有自己的适用领域。
````

6. 处理机调度算法的目标

````
1.资源利用率
CPU的利用率=CPU有效工作时间/（ CPU有效工作时间+CPU空闲等待时间）
2.公平性:进程获得的CPU时间合理
3.平衡性:不同类型的进程资源对应、平衡
4.策略强制执行：例如安全策略
````

7. 优先级倒置

````
高优先级进程（线程）被低优先级进程（线程）延迟或阻塞:共享临界资源,低优先级先进入临界区,倒置高优先级阻塞.

解决方法
1、进入临界区的进程所占用的处理机不允许被抢占。
2、当高优先级进入临界区时，如果已有一个低优先级进程正在使用该资源，低优先级进程继承高优先级进程的优先级，并一直保持到其退出临界区。
````

8. 产生死锁的必要条件 

````
互斥条件：进程互斥使用资源
请求和保持条件：申请新资源时不释放已占有资源
不剥夺条件：一个进程不能抢夺其他进程占有的资源
环路等待条件：存在一组进程循环等待资源的环形链
````

9. 处理死锁的基本方法    （填空/简答）

````
预防死锁：通过设置某些限制条件来破坏产生死锁的四个必要条件中的一个或几个，来预防发生死锁
避免死锁：在动态分配资源的过程中，用某种方法防止系统进入不安全状态，从而避免发生死锁
检测死锁：通过设置检测机制，及时检测出死锁的发生，确定有关的进程和资源
解除死锁：与检测死锁配套使用，常用的方法是撤销或挂起一些进程，收回资源，分配给处于阻塞状态的进程，使之转为就绪状态，可以继续运行
````

10. I/O系统的基本功能（答对5点即可）

````
1. 隐藏物理设备的细节：提供少量抽象读写
2. 与设备无关性:便于替换,更改
3. 提高处理机和I/O设备的利用率
4. 控制I/O设备
5. 设备正确共享
6. 错误处理：永久错误才上报
````

11.基于位示图盘块分配和回收流程

````
分配：顺序扫描位示图-转盘块号-对应置1
回收：盘块算行列之-对应置0
````

12.磁盘高速缓存(Disk Cache):   （简答全

````
周期性回写:为保证一致性,对那些一直在高速缓存中,可能被改动的数据周期性回写到磁盘

其它方法:1. 提前读(Read-Ahead) （填空1234

        2.延迟写 3. 优化物理块的分布 4. 虚拟盘 
````

13. 虚拟存储器

````
具有请求调入功能和置换功能， 能从逻辑上对内存容量加以扩充的一种存储器系统
离散，多次，对换，虚拟
多次性:作业无需一次性装入,可以分多次调入内存;每次只需调入需要的程序和数据.

对换性:作业的程序和数据也无需常驻内存,暂时不用的部分可以调出,需要时候再调入.

虚拟性:逻辑上扩充内存.从磁盘借用空间(机械磁盘和SSD!)

````

## 填空题总结

OS作为用户与计算机硬件系统之间的<u>接口</u>

 OS作为计算机系统资源的<u>管理者</u>：<u>处理器(计算)、存储器、I/O、文件</u>（数据、程序）四类资源

操作系统的特征：<u>并发性， 共享性， 虚拟性， 异步性</u>

程序的顺序执行时的特征 ： <u>顺序性 、封闭性、可再现性</u>

并发执行时的特征：<u>间断性、失去封闭性、不可再现性</u>

进程的基本状态 ：<u>就绪、执行、阻塞</u>

进程：<u>程序段、数据段、PCB</u>

进程的特征：<u>动态性(最基本)、并发性、独立性、异步性</u>

同步机制应遵循的规则 <u>空闲让进、忙则等待、有限等待、让权等待</u>

信号量：整型、<u>记录型、AND型、信号量集</u>

管程: 管程的名称、局部于管程的共享数据结构说明、对内部的共享数据初始化语句、对该数据结构进行操作的一组过程

优先级调度：<u>抢占/非抢占</u>优先级调度算法

产生死锁的必要条件 ：<u>互斥、请求和保持、不剥夺、环路等待</u>条件

处理死锁的基本方法：<u>预防死锁、避免xx、检测xx、解除xx</u>

程序的装入：<u>绝对装入、可重定位装入、动态运行时装入</u>   （会有阐述判断）

碎片问题的解决——<u>“拼接”或“紧凑”</u>

页表的作用是实现<u>从页号到物理块号的地址映射</u>

虚拟存储器的特征  <u>多次性，对换，虚拟</u>

影响缺页率的因素:<u>页面大小、物理块数、置换算法、程序固有特性</u>   

抖动解决方案：<u>工作集</u>（进程实际访问页面集合）

I/O设备控制方式：<u>轮询可编程IO、中断可编程IO、直接存储器访问（DMA控制）、IO通道</u>(判断，cpu参与，成本)

每种设备有自己的<u>中断处理程序</u>,程序入口记录在<u>**中断向量表**</u>中,并给予不同的<u>中断号和优先级</u>

为了实现设备的独立性，系统必须设置一张<u>逻辑设备表</u>(LUT)

影响磁盘性能：<u>寻道,旋转,传输</u>

磁盘调度目标: <u>使磁盘的平均寻道时间最少</u> 

目录管理的最重要：<u>实现“按名存取”</u>

外存的组织方式:<u>连续xx，链接xx，索引xx</u>组织方式

---

补充：pcb：进程标识符，处理机状态，进程调度信息，进程控制信息

线程核心思想:<u>调度和资源分开</u>

硬件地址变换机构的支持——<u>重定位寄存器</u>

## 判断题总结

并行同一时间，**并发性是同一时间间隔内**

顺序和并发执行区别

进程和线程

- 线程作为调度和分派的基本单位（进程是资源分配的基本单位）
- 一个进程可创建一个或多个子进程/线程
- 资源是分给进程的
- 处理机调度的基本单位是线程

局部变量只能被管程的过程访问；
进程通过调用管程的过程进入管程；
**只能有一个进程**在管程中执行。

处理机调度的层次：高（作业，长程调度）用于批处理，中内存，低进程，短程

先分段后页，页等段不等     页物理块

动态分区分配那些算法针对连续，**分页和分段均为离散存储**

联想寄存器（快表）存页表：存放当前访问的若干个页表项的一个高速缓

冲寄存器

虚拟存储器  逻辑  最大容量由计算机系统的**地址结构和内外存空间**决定。（选择判断   成本接近于**外存**

逻辑设备表 单系统一张，多系统每用户一张

文件逻辑与物理结构

- 文件的逻辑结构（文件的组织）：从**用户**角度看到的文件的全貌，也就是它的记录结构。
- 文件的物理结构（文件的存储结构）：文件在**外存**上的存储组织形式。

fcb和索引结点混着说判断

- 文件目录的缺陷:查找文件需要读入整个目录表(很大),实际只使用了文件名
- 索引结点的引入:文件名与文件信息分开

多用户一般都是两级目录，优缺点

- 两级目录具有以下优点：
  (1)提高了检索目录的速度 
  (2) 在<u>不同的用户目录中， 可以使用相同的文件名。</u> 
  (3) <u>不同用户还可使用不同的文件名来访问系统中的同一个共享文件</u> 
  但是不同用户文件之间的共享成为问题.

外存的组织方式:<u>连续xx，链接xx，索引xx</u>组织方式**理解原理，优缺点混合一起说**

卷，物理分区，物理磁盘，逻辑卷

- 在FAT中引入“卷”的概念，支持将物理磁盘分为四个逻辑磁盘，每个逻辑磁盘就是一个卷，也叫分区
- 每个卷都有专门区域存放FAT表和文件目录表，以及自己的逻辑驱动器字母

- 一个物理磁盘可以分为多个逻辑卷，一个逻辑卷也可以由多个物理磁盘组成

卷和卷因子区别

- 分区称为卷  （**FAT**里有的概念）
- **NTFS以簇**为磁盘空间分配和回收的基本单位，又称为卷因子。

位示图小型，成组链接法:大型文件系统

所有线程拥有相同的地址空间

页（页面）——把**每个作业(进程)逻辑地址**空间划分成若干大小相等的片.第0页、第1页
   (物理)块或页框(frame)——把**内存空间分成与页面相同大小**的若干个存储块。 0＃块、1＃块

## 大题总结

### 进程转换条件

![image-20241211200418859](C:\Users\Annie\AppData\Roaming\Typora\typora-user-images\image-20241211200418859.png)

### 前趋图

![image-20241211201644659](C:\Users\Annie\AppData\Roaming\Typora\typora-user-images\image-20241211201644659.png)

````
P1(){S1; signal(a); signal(b); }
P2(){wait(a); S2; signal(c); signal(d); }
P3(){wait(b); S3; signal(e);}
P4(){wait(c); S4; signal(f); }
P5(){wait(d); S5; signal(g); }
P6(){wait(e); wait(f); wait(g); S6; }
main(){
       semaphore a,b,c,d,e,f,g;
       a.value=b.value=c.value=d.value=e.value=0;
       f.value=g.value=0;
      cobegin
             P1();P2();P3();P4();P5();P6();
      coend;
}

````

生产消费

![image-20241212145632952](C:\Users\Annie\AppData\Roaming\Typora\typora-user-images\image-20241212145632952.png)

![image-20241212145648050](C:\Users\Annie\AppData\Roaming\Typora\typora-user-images\image-20241212145648050.png)

读者写者(见书)

给信号量赋初值：通常，互斥信号量为1，资源信号量为0或n
 （3）P、V操作安排的位置（其中，P的顺序不能颠倒，V的顺序任意）

### 处理机调度算法

（平均）周转时间

（平均）带权周转时间

![image-20241211202121021](C:\Users\Annie\AppData\Roaming\Typora\typora-user-images\image-20241211202121021.png)

### 安全状态

![image-20241212174120322](C:\Users\Annie\AppData\Roaming\Typora\typora-user-images\image-20241212174120322.png)

### 分页分段计算

多少页，一页占空间

一个段的大小，段长度

页表（逻辑地址->物理地址）

````
例题：某分页系统，主存容量为32KB，分成32块，对一个2页大的作业，其0、1页分别被分配到主存的2、4块中。
1）该系统的分页大小为多少？
2）作业的总长度是多少？
3）将逻辑地址1020转换成物理地址是多少？
答：
1）页面大小（块大小）=主存容量/块数=32k/32=1k
2）作业长度=页数×页面大小=2×1k=2k
3）首先计算在哪个逻辑页面：取整（逻辑地址/页面大小）=1020/1024（1k）=0  余 1020，0页，页内偏移1020. 其次，逻辑页面转换为物理块序号：0页存储在2号盘块，则物理地址=盘块序号×块大小+偏移=2×1024+1020=3068

采用段页式存储管理的系统中，若地址用32位表示，其中8位表示段号，则允许每段的最大长度是？？
2^24

````

![image-20241212194344551](C:\Users\Annie\AppData\Roaming\Typora\typora-user-images\image-20241212194344551.png)

### 页面置换算法（10）

缺页其实就是外调内

计算缺页率和置换率、

写过程：缺页次数和置换次数

置换=缺页-物理块数

最佳置换算法 以后不再访问的页或距现在最长

先进先出(FIFO)页面置换算法

最近最久未使用(LRU)置换算法

最少使用（Least Frequently Used）置换算法

时钟Clock置换算法 前2类  最好不访问不修改

### 磁盘调度算法

- 先来先服务FCFS(First-Come, First Served
- 最短寻道时间优先SSTF(Shortest Seek Time First)
- 扫描(SCAN)（电梯调度）算法
- 循环扫描(CSCAN)算法（不考）

答访问顺序 ，根据移动距离（磁道数）算平均寻道长度

### FAT 计算

FAT12/32/64

```
对于1.2 MB的软盘，每个盘块的大小为512 B，在每个FAT中共含有2.4 K 个表项，由于每个FAT 表项占12 位(1.5个B)，故FAT表占用3.6 KB的存储空间。

1.2MB/512B=2.4k个盘块
2.4K*1.5=3.6KB

假定盘块的大小为1K，对于1.2MB的软盘，在FAT12文件系统下， FAT表需占用(    )的存储空间。

注意：表项可能没用完！！！！（不要一来就最大）*
```

### 位示图法

给行列算块号

  b=n(i-1)+j   式中， n代表每行的位数。

  i=(b-1)DIV n+1(行,整除)
  j=(b-1)MOD n+1 (列,余数)

````
例题：如果利用20行，30列的位示图来标志空闲盘块的状态，在进行盘盘块分配时，当第一次找到的空闲盘块（即该位置为0）处于第11行，第18列，则相应的盘块号为_____。
b=n(i-1)+j=30(11-1)+18=318
````

## 选择题（知识点）总结

高响应比优先

照顾了短作业，又考虑了作业到达的先后顺序，还不会使长作业长期得不到服务。
该调度算法改进了FCFS和SJF算法的缺点。



**基于顺序搜索的动态分区分配算法**  优缺点

- ​       首次适应：第一个低址
- 循环首次适应 ：上次的下一个
- 最佳适应：排序最小
- 最坏适应：最大

### 常见设备分类

对I/O设备进行控制（填空/判断/选择
轮询可编程IO
中断可编程IO:打印机\键盘等低速设备
直接存储器访问（DMA控制方式）:磁盘,光驱等高速设备   I/O设备直接与主存交换数据

根据设备类型不同,分为:
块设备接口(磁盘,光盘)
流设备接口：字符设备接口(键盘,打印机等),

可重用性资源：IO设备、打印机等
可消耗性资源（临时资源）：进程间通信的消息等

可抢占性资源（可剥夺资源）：CPU、内存
不可抢占性资源（非可剥夺资源）：磁带机、打印机

打印机、CPU 、扫描仪、内存、磁盘，鼠标，键盘

### 目录管理的要求（选择

(1)实现“按名存取”。 （最重要
(2) 提高对目录的检索速度。 
(3) 文件共享。 
(4) 允许文件重名。 

### 文件

按文件的性质和用途分为：系统文件，库文件，用户文件
按文件中数据的形式分类 ：源文件，目标文件，可执行文件
按存取控制属性分类：只**执行**文件，**只读**文件，**读写**文件

---

并发和共享是操作系统两个最基本的特征

只有在不存在前驱关系的程序之间才有可能并发执行

虚拟存储器， 是指具有**请求调入**功能和**置换**功能， 能从**逻辑上**对内存容量加以扩充的一种存储器系统

![image-20241212205156988](C:\Users\Annie\AppData\Roaming\Typora\typora-user-images\image-20241212205156988.png)

设备驱动抽象要求转换为具体操作

I/O设备的控制方式

- 轮询可编程IO：需要则CPU启动I/O设备，且不断**查询**I/O设备的**准备**情况
- 中断可编程IO: CPU启动I/O设备后，不必查询I/O设备是否就绪，等待设备中断
- 直接存储器访问: I/O设备能**直接与主存**交换数据而不占用CPU
- IO通道:最大程度解放CPU,专门管理IO，CPU从读写一个数据块变为对一组数据块的读写与控制.实现CPU,IO设备,通道三者并行操作

IO通道**:独立**于CPU的专门负责**数据**输入/输出传输工作的处理机

设备,控制器, 通道三者都分配成功才是设备分配成功

 SPOOLing技术——假脱机系统

SPOOLing:将**一**台物理设备虚拟为**多**台逻辑设备,让多用户共享

 了解 守护进程daemon---独占

基本数据项：是数据组织中可以命名的最小逻辑数据单位

拷贝权所有权--列



FAT12
每个FAT表项为12位，所以FAT表中最多允许4K表项，盘块（扇区）512B，每一个磁盘分区的容量为：4K*512B=2MB

